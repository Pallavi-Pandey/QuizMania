server {
    listen 80;

    location / {
        root /usr/share/nginx/html;
        index index.html index.htm;
        try_files $uri $uri/ /index.html;
    }

    location /api/ {
        proxy_pass http://backend:8000/api/;
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
    }

    # Proxy other endpoints that are not strictly /api but handled by backend
    # Based on app.py, there are endpoints like /register, /token, /quizzes, etc.
    # Ideally all backend routes should be under /api, but for now we proxy specific ones or everything else?
    # The app.py has mixed routes. Let's proxy specific known non-api routes or just rely on frontend proxy in dev.
    # In production with nginx, we need to be explicit.
    
    # Let's proxy common auth and root level endpoints
    location /register {
        proxy_pass http://backend:8000/register;
    }
    
    location /token {
        proxy_pass http://backend:8000/token;
    }

    location /quizzes {
        proxy_pass http://backend:8000/quizzes;
    }

    location /leaderboard {
        proxy_pass http://backend:8000/leaderboard;
    }
    
    location /submit-quiz {
        proxy_pass http://backend:8000/submit-quiz;
    }

    location /create-quiz {
        proxy_pass http://backend:8000/create-quiz;
    }
    
    location /categories {
        proxy_pass http://backend:8000/categories;
    }
    
    location /search {
        proxy_pass http://backend:8000/search;
    }
    
    location /quiz-history {
        proxy_pass http://backend:8000/quiz-history;
    }
    
    location /user-stats {
        proxy_pass http://backend:8000/user-stats;
    }
    
    location /quiz-analytics {
        proxy_pass http://backend:8000/quiz-analytics;
    }
    
    location /creator-analytics {
        proxy_pass http://backend:8000/creator-analytics;
    }
    
    location /recommendations {
        proxy_pass http://backend:8000/recommendations;
    }
    
    location /export-quiz {
        proxy_pass http://backend:8000/export-quiz;
    }
    
    location /import-quiz {
        proxy_pass http://backend:8000/import-quiz;
    }
    
    location /export-multiple-quizzes {
        proxy_pass http://backend:8000/export-multiple-quizzes;
    }
    
    location /quiz-collaboration {
        proxy_pass http://backend:8000/quiz-collaboration;
    }
}
